<%- include('templates/headerAfterLogin') %>

<style>
  .btn {
    margin-right: 10px;

  }
</style>
<div class="row d-flex align-items-center justify-content-center">
  <div class="col-md-3">
      <div class="flex flex-col items-center justify-center">
        <div class="text-center">
          <img src='/img/mainlogo.png' alt="Logo" width="130" height="120">
      </div>
          <h1 style='text-align: center' class="hello">Welcome, <%= name %>!</h1>
          <h4 style='text-align: center'class="capping">Let's get capping!</h4>
      </div>
  </div>
  <div class="col-md-6">
      <div class="mt-4">
          <h3 class="text-xl font-bold text-green">Dashboard</h3>
          <div class="bg-white shadow mt-2 p-4 rounded-lg">
              <div class="flex items-center justify-between space-x-2">
                  <button class="btn btn-success">Month</button>
                  <button class="btn btn-success">Week</button>
                  <button class="btn btn-success">See more</button>
              </div>
              <div class="mt-4">
                  <canvas id="myChart"></canvas>
              </div>
          </div>
      </div>
  </div>

  <!-- Cap of the day.-->
  <div class="col-md-3">
    <div class="card">
      <h5 class="card-header">CAP OF THE DAY</h5>
      <div class="card-body">
        <p id="factText" class="card-text"></p>
        <p id="factSource" class="text-sm text-green font-bold mt-1"></p>
        <div class="d-flex justify-content-between mt-2">
          <button id="moreFacts" class="btn btn-success">More facts</button>
          <button id="readMore" class="btn btn-success">Read more</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"
  integrity="sha512-ElR16o87II1Y6n0Z8e3c8638oa32310bF7h+t25t3v6e0uztq6/PXF3g82w863P2r212+r68n37568432655"
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  // Fetch facts from the JSON file called facts.json
  fetch('../json/facts.json')
      .then(response => response.json())
      .then(data => {
          const facts = data.facts;

          function getRandomFact() {
              const randomNumber = Math.floor(Math.random() * facts.length);
              const randomFact = facts[randomNumber];
              document.getElementById('factText').innerText = randomFact.fact;
              document.getElementById('factSource').innerText = randomFact.source;
          }

          // This is the new initial fact when the user loads the page
          getRandomFact();

          // Click "More facts" button click to generate a new random fact.
          document.getElementById('moreFacts').addEventListener('click', getRandomFact);
      })
      .catch(error => console.error('Error fetching facts:', error));
</script>

<!-- Template should actually be afterlogin footer template -->
<%- include('templates/footerAfterLogin') %>